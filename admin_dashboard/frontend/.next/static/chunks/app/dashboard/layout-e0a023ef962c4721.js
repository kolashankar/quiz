(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[663],{23271:function(e,t,r){Promise.resolve().then(r.bind(r,97123))},99376:function(e,t,r){"use strict";var n=r(35475);r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},97123:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var n=r(57437),a=r(5127),o=r(99376),s=r(2265),i=r(61241);function u(e){let{children:t}=e,{user:r,isLoading:u}=(0,a.a)(),c=(0,o.useRouter)();return((0,s.useEffect)(()=>{u||r?!u&&r&&"admin"!==r.role&&c.push("/auth/login"):c.push("/auth/login")},[r,u,c]),u)?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(i.$,{size:"lg"}),(0,n.jsx)("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Loading dashboard..."})]})}):r&&"admin"===r.role?(0,n.jsx)(n.Fragment,{children:t}):(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Access Denied"}),(0,n.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"You need admin privileges to access this dashboard."})]})})}},61241:function(e,t,r){"use strict";r.d(t,{$:function(){return a}});var n=r(57437);function a(e){let{size:t="md",color:r="primary",className:a=""}=e;return(0,n.jsxs)("svg",{className:"animate-spin ".concat({sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"}[t]," ").concat({primary:"text-blue-600",white:"text-white",gray:"text-gray-600"}[r]," ").concat(a),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}r(2265)},5127:function(e,t,r){"use strict";r.d(t,{H:function(){return u},a:function(){return c}});var n=r(57437),a=r(2265),o=r(26647),s=r(69064);let i=(0,a.createContext)(void 0);function u(e){let{children:t}=e,[r,u]=(0,a.useState)(null),[c,l]=(0,a.useState)(!0),[d,h]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{let e=localStorage.getItem("auth_token");if(e){h(e);try{let e=await o.O.getCurrentUser();u(e)}catch(e){localStorage.removeItem("auth_token"),h(null)}}l(!1)})()},[]);let g=async e=>{try{l(!0);let t=await o.O.login(e);return h(t.token),u(t.user),localStorage.setItem("auth_token",t.token),s.ZP.success("Login successful!"),t}catch(e){throw s.ZP.error(e.message||"Login failed"),e}finally{l(!1)}};return(0,n.jsx)(i.Provider,{value:{user:r,token:d,isLoading:c,login:g,logout:()=>{u(null),h(null),localStorage.removeItem("auth_token"),s.ZP.success("Logged out successfully")}},children:t})}function c(){let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},26647:function(e,t,r){"use strict";r.d(t,{O:function(){return a},h:function(){return n}});let n=r(83464).Z.create({baseURL:"http://localhost:8001/api",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{let t=localStorage.getItem("auth_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),n.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("auth_token"),window.location.href="/auth/login"),Promise.reject(e)});let a={async login(e){try{return(await n.post("/auth/login",e)).data}catch(e){var t,r;throw Error((null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.error)||"Login failed")}},async register(e){try{return(await n.post("/auth/register",e)).data}catch(e){var t,r;throw Error((null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.error)||"Registration failed")}},async getCurrentUser(){try{return(await n.get("/auth/me")).data.user}catch(r){var e,t;throw Error((null===(t=r.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||"Failed to get user")}},logout(){localStorage.removeItem("auth_token")}}}},function(e){e.O(0,[464,64,971,117,744],function(){return e(e.s=23271)}),_N_E=e.O()}]);