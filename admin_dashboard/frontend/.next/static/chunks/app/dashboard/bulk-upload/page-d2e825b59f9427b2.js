(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[668],{25713:function(e,t,s){Promise.resolve().then(s.bind(s,99396))},99396:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var a=s(57437),r=s(2265),l=s(65725),i=s(51351),n=s(17653),d=s(1442),c=s(47842),o=s(77165),x=s(19672),m=s(26647),u=s(69064),h=s(27648);function p(){let[e,t]=(0,r.useState)(null),[s,p]=(0,r.useState)(!1),[g,f]=(0,r.useState)([]),[y,j]=(0,r.useState)([]),[v,b]=(0,r.useState)(0),[N,w]=(0,r.useState)(null),k=(0,r.useCallback)(e=>{let s=e[0];s&&"text/csv"===s.type?(t(s),U(s)):u.ZP.error("Please select a valid CSV file")},[]),{getRootProps:C,getInputProps:S,isDragActive:I}=(0,l.uI)({onDrop:k,accept:{"text/csv":[".csv"]},multiple:!1,maxSize:5242880}),U=e=>{let t=new FileReader;t.onload=e=>{var t;let s=(null===(t=e.target)||void 0===t?void 0:t.result).split("\n");s[0].split(",").map(e=>e.trim());let a=[],r=[];for(let e=1;e<s.length;e++){if(""===s[e].trim())continue;let t=s[e].split(",").map(e=>e.trim());if(t.length<10){r.push({row:e+1,field:"general",message:"Insufficient columns"});continue}let l={subsectionId:t[0],questionText:t[1],option1:t[2],option2:t[3],option3:t[4],option4:t[5],correctAnswer:parseInt(t[6])||0,difficulty:t[7]||"medium",tags:t[8]||"",explanation:t[9]||"",timeLimit:parseInt(t[10])||60,marks:parseInt(t[11])||1};l.subsectionId||r.push({row:e+1,field:"subsectionId",message:"Subsection ID is required"}),l.questionText||r.push({row:e+1,field:"questionText",message:"Question text is required"}),l.option1&&l.option2&&l.option3&&l.option4||r.push({row:e+1,field:"options",message:"All 4 options are required"}),(l.correctAnswer<0||l.correctAnswer>3)&&r.push({row:e+1,field:"correctAnswer",message:"Correct answer must be 0-3"}),["easy","medium","hard"].includes(l.difficulty.toLowerCase())||r.push({row:e+1,field:"difficulty",message:"Difficulty must be easy, medium, or hard"}),a.push(l)}f(a),j(r)},t.readAsText(e)},q=async()=>{if(!e||y.length>0){u.ZP.error("Please fix validation errors before uploading");return}p(!0),b(0);try{let s=new FormData;s.append("file",e);let a=setInterval(()=>{b(e=>e>=90?(clearInterval(a),e):e+10)},200),r=await m.h.post("/admin/questions/bulk-upload",s,{headers:{"Content-Type":"multipart/form-data"}});clearInterval(a),b(100),w(r.data),u.ZP.success("Successfully uploaded ".concat(r.data.successful," questions")),setTimeout(()=>{t(null),f([]),b(0),w(null)},3e3)}catch(e){var s,a;u.ZP.error("Upload failed: "+((null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.message)||e.message))}finally{p(!1)}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 shadow-sm border-b",children:(0,a.jsxs)("div",{className:"px-4 sm:px-6 lg:px-8 py-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"CSV Bulk Upload"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Upload multiple questions using CSV format"})]}),(0,a.jsxs)("button",{onClick:()=>{let e=new Blob(['subsectionId,questionText,option1,option2,option3,option4,correctAnswer,difficulty,tags,explanation,timeLimit,marks\n641e4f5b2c8d4b0012345678,"What is 2+2?","2","3","4","5",2,"easy","math,arithmetic","Simple addition",60,1\n641e4f5b2c8d4b0012345679,"What is the capital of France?","London","Berlin","Paris","Madrid",2,"easy","geography,europe","Paris is the capital and largest city of France",45,1'],{type:"text/csv"}),t=window.URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="questions_template.csv",s.click(),window.URL.revokeObjectURL(t)},className:"btn-secondary flex items-center space-x-2",children:[(0,a.jsx)(i.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Download Template"})]})]}),(0,a.jsx)("nav",{className:"flex mt-4",children:(0,a.jsxs)("ol",{className:"flex items-center space-x-2",children:[(0,a.jsx)("li",{children:(0,a.jsx)(h.default,{href:"/dashboard",className:"text-gray-500 hover:text-gray-700",children:"Dashboard"})}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"mx-2",children:"/"}),(0,a.jsx)("span",{children:"Bulk Upload"})]})]})})]})}),(0,a.jsxs)("div",{className:"px-4 sm:px-6 lg:px-8 py-8 max-w-4xl mx-auto",children:[(0,a.jsx)("div",{className:"card p-8 mb-6",children:(0,a.jsxs)("div",{...C(),className:"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ".concat(I?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400"),children:[(0,a.jsx)("input",{...S()}),(0,a.jsx)(n.Z,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e?(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["Selected: ",e.name]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(e.size/1024).toFixed(1)," KB"]})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-lg font-medium text-gray-900 dark:text-white",children:I?"Drop the CSV file here":"Drag & drop your CSV file here"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"Or click to select a file (Max 5MB)"})]})]})}),s&&(0,a.jsxs)("div",{className:"card p-6 mb-6",children:[(0,a.jsx)("div",{className:"flex items-center mb-2",children:(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Uploading... ",v,"%"]})}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(v,"%")}})})]}),N&&(0,a.jsxs)("div",{className:"card p-6 mb-6 border-green-200 bg-green-50 dark:bg-green-900/20",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(d.Z,{className:"h-6 w-6 text-green-600 mr-2"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-green-800 dark:text-green-200",children:"Upload Completed"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-green-600 font-medium",children:N.successful}),(0,a.jsx)("span",{className:"text-gray-600 dark:text-gray-400 ml-1",children:"Successful"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-red-600 font-medium",children:N.failed||0}),(0,a.jsx)("span",{className:"text-gray-600 dark:text-gray-400 ml-1",children:"Failed"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-blue-600 font-medium",children:N.total}),(0,a.jsx)("span",{className:"text-gray-600 dark:text-gray-400 ml-1",children:"Total"})]})]})]}),y.length>0&&(0,a.jsxs)("div",{className:"card p-6 mb-6 border-red-200 bg-red-50 dark:bg-red-900/20",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(c.Z,{className:"h-6 w-6 text-red-600 mr-2"}),(0,a.jsxs)("h3",{className:"text-lg font-semibold text-red-800 dark:text-red-200",children:["Validation Errors (",y.length,")"]})]}),(0,a.jsx)("div",{className:"max-h-48 overflow-y-auto",children:y.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center py-2 text-sm",children:[(0,a.jsxs)("span",{className:"text-red-600 font-medium mr-2",children:["Row ",e.row,":"]}),(0,a.jsxs)("span",{className:"text-red-800 dark:text-red-200",children:[e.field," - ",e.message]})]},t))})]}),g.length>0&&(0,a.jsxs)("div",{className:"card p-6 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Data Preview (",g.length," rows)"]}),e&&(0,a.jsx)("button",{onClick:()=>{t(null),f([]),j([])},className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)(o.Z,{className:"h-5 w-5"})})]}),(0,a.jsxs)("div",{className:"overflow-x-auto",children:[(0,a.jsxs)("table",{className:"min-w-full text-sm",children:[(0,a.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-3 py-2 text-left font-medium text-gray-900 dark:text-white",children:"Question"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left font-medium text-gray-900 dark:text-white",children:"Options"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left font-medium text-gray-900 dark:text-white",children:"Correct"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left font-medium text-gray-900 dark:text-white",children:"Difficulty"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:g.slice(0,5).map((e,t)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-3 py-2 max-w-xs truncate",children:e.questionText}),(0,a.jsx)("td",{className:"px-3 py-2",children:(0,a.jsxs)("div",{className:"text-xs space-y-1",children:[(0,a.jsxs)("div",{children:["A: ",e.option1]}),(0,a.jsxs)("div",{children:["B: ",e.option2]}),(0,a.jsxs)("div",{children:["C: ",e.option3]}),(0,a.jsxs)("div",{children:["D: ",e.option4]})]})}),(0,a.jsx)("td",{className:"px-3 py-2",children:String.fromCharCode(65+e.correctAnswer)}),(0,a.jsx)("td",{className:"px-3 py-2",children:(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("easy"===e.difficulty?"bg-green-100 text-green-800":"medium"===e.difficulty?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.difficulty})})]},t))})]}),g.length>5&&(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:["... and ",g.length-5," more rows"]})]})]}),e&&g.length>0&&(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsxs)("button",{onClick:q,disabled:s||y.length>0,className:"px-8 py-3 rounded-lg font-medium flex items-center space-x-2 ".concat(s||y.length>0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:[(0,a.jsx)(x.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:s?"Uploading...":"Upload ".concat(g.length," Questions")})]})})]})]})}},26647:function(e,t,s){"use strict";s.d(t,{O:function(){return r},h:function(){return a}});let a=s(83464).Z.create({baseURL:"http://localhost:8001/api",headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{let t=localStorage.getItem("auth_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),a.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("auth_token"),window.location.href="/auth/login"),Promise.reject(e)});let r={async login(e){try{return(await a.post("/auth/login",e)).data}catch(e){var t,s;throw Error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Login failed")}},async register(e){try{return(await a.post("/auth/register",e)).data}catch(e){var t,s;throw Error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Registration failed")}},async getCurrentUser(){try{return(await a.get("/auth/me")).data.user}catch(s){var e,t;throw Error((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||"Failed to get user")}},logout(){localStorage.removeItem("auth_token")}}}},function(e){e.O(0,[464,64,648,182,971,117,744],function(){return e(e.s=25713)}),_N_E=e.O()}]);