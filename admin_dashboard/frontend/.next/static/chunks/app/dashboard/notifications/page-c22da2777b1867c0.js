(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[258],{72122:function(e,t,a){Promise.resolve().then(a.bind(a,89193))},89193:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var s=a(57437),r=a(2265);let i=r.forwardRef(function(e,t){let{title:a,titleId:s,...i}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},i),a?r.createElement("title",{id:s},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5"}))});var l=a(23121),n=a(78931),d=a(88203),o=a(69064),c=a(29501),x=a(83464);function m(){let[e,t]=(0,r.useState)([]),[a,m]=(0,r.useState)([]),[g,h]=(0,r.useState)(!0),[u,y]=(0,r.useState)(!1),[b,p]=(0,r.useState)(!1),{register:f,handleSubmit:j,reset:v,watch:N,formState:{errors:w}}=(0,c.cI)({defaultValues:{targetType:"all"}}),k=N("targetType");(0,r.useEffect)(()=>{S(),Z()},[]);let S=async()=>{try{h(!0);let e=localStorage.getItem("token"),a=await x.Z.get("".concat("http://localhost:8001/api","/api/admin/notifications/history"),{headers:{Authorization:"Bearer ".concat(e)}});t(a.data)}catch(e){o.ZP.error("Failed to fetch notifications")}finally{h(!1)}},Z=async()=>{try{let e=localStorage.getItem("token"),t=await x.Z.get("".concat("http://localhost:8001/api","/api/admin/exams"),{headers:{Authorization:"Bearer ".concat(e)}});m(t.data)}catch(e){o.ZP.error("Failed to fetch exams")}},T=async e=>{p(!0);try{let t=localStorage.getItem("token"),a={title:e.title,body:e.body};"exam"===e.targetType&&e.examId&&(a.examId=e.examId);let s=await x.Z.post("".concat("http://localhost:8001/api","/api/admin/notifications/send"),a,{headers:{Authorization:"Bearer ".concat(t)}});s.data.success?o.ZP.success("Notification sent to ".concat(s.data.sent_count," users!")):o.ZP.error(s.data.message||"Failed to send notification"),y(!1),S()}catch(e){var t,a;o.ZP.error((null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.error)||"Failed to send notification")}finally{p(!1)}},C=async()=>{try{let e=localStorage.getItem("token");await x.Z.post("".concat("http://localhost:8001/api","/api/admin/notifications/test"),{title:"Test Notification",body:"This is a test notification from admin panel"},{headers:{Authorization:"Bearer ".concat(e)}}),o.ZP.success("Test notification sent!")}catch(e){o.ZP.error("Failed to send test notification")}};return(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Push Notifications"}),(0,s.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Send targeted push notifications to users"})]}),(0,s.jsxs)("div",{className:"mb-6 flex gap-3",children:[(0,s.jsxs)("button",{onClick:()=>{v({title:"",body:"",examId:"",targetType:"all"}),y(!0)},className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[(0,s.jsx)(i,{className:"w-5 h-5 mr-2"}),"Send Notification"]}),(0,s.jsxs)("button",{onClick:C,className:"flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition",children:[(0,s.jsx)(l.Z,{className:"w-5 h-5 mr-2"}),"Send Test"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Sent"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e.reduce((e,t)=>e+t.sentCount,0)})]}),(0,s.jsx)(l.Z,{className:"w-12 h-12 text-blue-500"})]})}),(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Campaigns"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e.length})]}),(0,s.jsx)(n.Z,{className:"w-12 h-12 text-green-500"})]})}),(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Success Rate"}),(0,s.jsxs)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[e.length>0?Math.round(e.filter(e=>"sent"===e.status).length/e.length*100):0,"%"]})]}),(0,s.jsx)(i,{className:"w-12 h-12 text-purple-500"})]})})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Notification History"})}),g?(0,s.jsx)("div",{className:"text-center py-8",children:"Loading..."}):e.length>0?(0,s.jsx)("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:e.map(e=>(0,s.jsx)("div",{className:"px-6 py-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition",children:(0,s.jsx)("div",{className:"flex items-start justify-between",children:(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e.title}),(0,s.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat("sent"===e.status?"bg-green-100 text-green-700":"failed"===e.status?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),children:e.status})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:e.body}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[(0,s.jsxs)("span",{children:["Sent to ",e.sentCount," users"]}),(0,s.jsx)("span",{children:"â€¢"}),(0,s.jsx)("span",{children:new Date(e.createdAt).toLocaleString()})]})]})})},e.id))}):(0,s.jsx)("div",{className:"text-center py-12 text-gray-500",children:"No notifications sent yet. Send your first notification!"})]}),(0,s.jsx)(d.u,{isOpen:u,onClose:()=>y(!1),title:"Send Push Notification",children:(0,s.jsxs)("form",{onSubmit:j(T),className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Target Audience ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsxs)("select",{...f("targetType",{required:!0}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",children:[(0,s.jsx)("option",{value:"all",children:"All Users"}),(0,s.jsx)("option",{value:"exam",children:"Users by Exam"})]})]}),"exam"===k&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Select Exam ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsxs)("select",{...f("examId",{required:"exam"===k}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",children:[(0,s.jsx)("option",{value:"",children:"Select Exam"}),a.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Title ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("input",{type:"text",...f("title",{required:"Title is required"}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Notification title"}),w.title&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:w.title.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Message ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("textarea",{...f("body",{required:"Message is required"}),rows:4,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Notification message"}),w.body&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:w.body.message})]}),(0,s.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,s.jsx)("button",{type:"button",onClick:()=>y(!1),disabled:b,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition disabled:opacity-50",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:b,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 flex items-center justify-center",children:b?(0,s.jsx)(s.Fragment,{children:"Sending..."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i,{className:"w-4 h-4 mr-2"}),"Send Notification"]})})]})]})})]})}},88203:function(e,t,a){"use strict";a.d(t,{u:function(){return o}});var s=a(57437),r=a(2265),i=a(33044),l=a(93109),n=a(77165);let d={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl"};function o(e){let{isOpen:t,onClose:a,title:o,children:c,size:x="md"}=e;return(0,s.jsx)(i.u,{appear:!0,show:t,as:r.Fragment,children:(0,s.jsxs)(l.V,{as:"div",className:"relative z-50",onClose:a,children:[(0,s.jsx)(i.u.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25 dark:bg-opacity-50"})}),(0,s.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,s.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,s.jsx)(i.u.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,s.jsxs)(l.V.Panel,{className:"w-full ".concat(d[x]," transform overflow-hidden rounded-2xl bg-white dark:bg-gray-800 p-6 text-left align-middle shadow-xl transition-all"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)(l.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white",children:o}),(0,s.jsx)("button",{type:"button",className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",onClick:a,children:(0,s.jsx)(n.Z,{className:"h-6 w-6"})})]}),(0,s.jsx)("div",{children:c})]})})})})]})})}},23121:function(e,t,a){"use strict";var s=a(2265);let r=s.forwardRef(function(e,t){let{title:a,titleId:r,...i}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},i),a?s.createElement("title",{id:r},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))});t.Z=r},78931:function(e,t,a){"use strict";var s=a(2265);let r=s.forwardRef(function(e,t){let{title:a,titleId:r,...i}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},i),a?s.createElement("title",{id:r},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))});t.Z=r}},function(e){e.O(0,[464,64,501,67,971,117,744],function(){return e(e.s=72122)}),_N_E=e.O()}]);